# Numbers

def a = 101,
01010101001,
0x1ABCDEFabcdef,
0o7632157312,
1e+3

==>

Rel(
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    JoinExpression(
                        JoinExpression(
                            JoinExpression(
                                JoinExpression(
                                    OverrideExpression(
                                        RestrictExpression(
                                            LogicalExpression(
                                                BasicExpression(Literal(BaseLiteral(IntLiteral))))))),
                                OverrideExpression(
                                    RestrictExpression(
                                        LogicalExpression(
                                            BasicExpression(Literal(BaseLiteral(IntLiteral))))))),
                            OverrideExpression(
                                RestrictExpression(
                                    LogicalExpression(
                                        BasicExpression(Literal(BaseLiteral(IntLiteral))))))),
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral))))))),
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(FloatLiteral)))))))))))


# Booleans

def a = true
def b = false

==>

Rel(
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BooleanLiteral))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BooleanLiteral))))))))))


# Strings & Char


def a = "A string with \"double\" and 'single' quotes"
def b = """A Multi-line string
New line
"""
def c = 'A'
def d = raw"""""""
A raw string with "quotes" & """Multi-line quotes""" \\ Slashes
"""""""
def e = raw"""""""""""
A raw string with 11 quotes
"""""""""""
def f = raw""

==>

Rel(
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(StaticStringLiteral)))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(StaticMultilineStringLiteral)))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(CharLiteral)))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(
                                    Literal(
                                        BaseLiteral(RawStringLiteral(Keyword, RawStringSequence))))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(
                                    Literal(
                                        BaseLiteral(RawStringLiteral(Keyword, RawStringSequence))))))))))),
    DefinitionDeclaration(
            Keyword, LhsId(BasicId), Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(
                                        Literal(
                                            BaseLiteral(RawStringLiteral(Keyword, RawStringSequence))))))))))))


# Relnames

def a = :test
def b = :[]
def c = :"A string relname literal"

==>

Rel(
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(RelnameLiteral)))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(RelnameLiteral)))))))))),
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(RelnameStringLiteral)))))))))))

# Annotations

@inline
@function
@static
@inline
@ondemand
def a = 1

==>

Rel(
    DefinitionDeclaration(
        Annotation(AnnotationKeyword(BasicId)),
        Annotation(AnnotationKeyword(BasicId)),
        Annotation(AnnotationKeyword(BasicId)),
        Annotation(AnnotationKeyword(BasicId)),
        Annotation(AnnotationKeyword(BasicId)),
        Keyword,
        LhsId(BasicId),
        Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))))


# Emphasis Keywords

def output = A
def insert = B
def delete = C
def abort = D
def export = E


==>

Rel(
    DefinitionDeclaration(
        Keyword, LhsId(Emphasis), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))),
    DefinitionDeclaration(
        Keyword, LhsId(Emphasis), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))),
    DefinitionDeclaration(
        Keyword, LhsId(Emphasis), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))),
    DefinitionDeclaration(
        Keyword, LhsId(Emphasis), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))),

    DefinitionDeclaration(
        Keyword, LhsId(Emphasis), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))))


# Module Declaration

module store def a = 1 end

==>

Rel(
    ModuleDeclaration(
        Keyword, LhsId(BasicId), DefinitionDeclaration(
            Keyword, LhsId(BasicId), Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        Keyword))

# Value-Type Declaration

value type Distance = Float

==>

Rel(
    ValueTypeDeclaration(
        Keyword, Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))))

# Entity-Type Declaration

entity type Professional = String, String

==>

Rel(
    EntityTypeDeclaration(
        Keyword, Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(BasicId))))),
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))))

# Constraint Declaration

ic() {
    student ⊆ person
    // Can also be written as `subset(student, person)`.
}

==>

Rel(
    ConstraintDeclaration(
        Keyword, FormalParamsParen, Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(
                                    BasicExpression(BasicId),
                                    OperatorKeyword,
                                    BasicExpression(BasicId)))))))),
        LineComment))

# Bound Declaration

bound R = Int

==>

Rel(
    BoundDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(BasicId)))))))))



# With-Use Declaration

with mod use a, b, c

==>

Rel(
    WithUseDeclaration(
        Keyword,
        Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(BasicExpression(BasicId))))))),
        Keyword,
        Alias(BasicId),
        Alias(BasicId),
        Alias(BasicId)))



# DocStrings


doc"A single-line docstring"
def a = 1

doc"""
    A multi-line docstring with escape sequence \\ \n
"""
def a = 1

doc"""""
    A multi-line raw docstring """ \ """
"""""
def a = 1

doc"""""
    Another multi-line raw docstring """ \ """
"""""
def a = 1

==>

Rel(
    DefinitionDeclaration(
        Docstring(Keyword, RawStringSequence), Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
    DefinitionDeclaration(
        Docstring(Keyword, RawStringSequence), Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
    DefinitionDeclaration(
        Docstring(Keyword, RawStringSequence), Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
    DefinitionDeclaration(
        Docstring(Keyword, RawStringSequence), Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))))

# Comments
// A single-line comment
/****
    // A multi-line comment
*****/
def a = 1

==>

Rel(
    LineComment,
    BlockComment,
    DefinitionDeclaration(
        Keyword, LhsId(BasicId), Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))))

# Interpolation
def output = """
    %(
        string_join["\n", {
            """
                def n[x] = %(
                    x + 1
                )
            """
        }]
    )

"""

def a = "%b"

==>

Rel(
    DefinitionDeclaration(
        Keyword,
        LhsId(Emphasis),
        Expression(UnionExpression(JoinExpression(OverrideExpression(RestrictExpression(LogicalExpression(
            BasicExpression(Literal(InterpolationMultilineLiteral(Interpolation(InterpolationExpression(
                Expression(UnionExpression(JoinExpression(OverrideExpression(RestrictExpression(LogicalExpression(
                    BasicExpression(PartialApplicationExpression(
                        BasicExpression(BasicId),
                        LogicalParam(LogicalExpression(BasicExpression(Literal(BaseLiteral(StaticStringLiteral))))),
                        LogicalParam(LogicalExpression(BasicExpression(BoundedExpression(
                            Expression(UnionExpression(JoinExpression(OverrideExpression(RestrictExpression(LogicalExpression(
                                BasicExpression(Literal(InterpolationMultilineLiteral(Interpolation(InterpolationExpression(
                                    Expression(UnionExpression(JoinExpression(OverrideExpression(RestrictExpression(LogicalExpression(
                                        BasicExpression(
                                            BasicExpression(BasicId),
                                            OperatorKeyword,
                                            BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))))
                                ))))
                            ))))))
                        ))))
                    ))
                ))))))
            )))))
        ))))))
    ),
    DefinitionDeclaration(
        Keyword,
        LhsId(BasicId),
        Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(
                                    Literal(InterpolationLiteral(Interpolation(InterpolationId)))))))))))
)

# Constructors

def ^b = ^B[1, 2]

==>

Rel(
    DefinitionDeclaration(
        Keyword,
        LhsId(ConstructorId),
        Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(
                                    PartialApplicationExpression(
                                        BasicExpression(ConstructorId),
                                        LogicalParam(
                                            LogicalExpression(
                                                BasicExpression(Literal(BaseLiteral(IntLiteral))))),
                                        LogicalParam(
                                            LogicalExpression(
                                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))))))))

# Expression

@inline
@static(1, :rel)
{
    1 + 2;
    2023-07-01;
    2023-07-01T00:00:00Z
}

==>

Rel(
    Annotation(AnnotationKeyword(BasicId)),
    Annotation(
        AnnotationKeyword(BasicId),
        AnnotationParams(BaseLiteral(IntLiteral), BaseLiteral(RelnameLiteral))
    ),
    Expression(
        UnionExpression(
            JoinExpression(
                OverrideExpression(
                    RestrictExpression(
                        LogicalExpression(
                            BasicExpression(
                                BoundedExpression(
                                    Expression(
                                        UnionExpression(
                                            UnionExpression(
                                                UnionExpression(
                                                    JoinExpression(
                                                        OverrideExpression(
                                                            RestrictExpression(
                                                                LogicalExpression(
                                                                    BasicExpression(
                                                                        BasicExpression(Literal(BaseLiteral(IntLiteral))),
                                                                        OperatorKeyword,
                                                                        BasicExpression(Literal(BaseLiteral(IntLiteral))))))))),
                                                JoinExpression(
                                                    OverrideExpression(
                                                        RestrictExpression(
                                                            LogicalExpression(
                                                                BasicExpression(Literal(BaseLiteral(DateLiteral)))))))),
                                            JoinExpression(
                                                OverrideExpression(
                                                    RestrictExpression(
                                                        LogicalExpression(
                                                            BasicExpression(Literal(BaseLiteral(DateTimeLiteral))))))))))))))))))



# Extended Keywords

module a
    def doc = 1
    def value = 2
    def entity = 3
    def type = 4
    def raw = 5
    def implies = 6
    def iff = 7
    def xor = 8
end

==>

Rel(
    ModuleDeclaration(
        Keyword,
        LhsId(BasicId),
        DefinitionDeclaration(
            Keyword,
            LhsId(BasicId),
            Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
            Keyword,
            LhsId(Keyword),
            Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
            Keyword,
            LhsId(Keyword),
            Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
            Keyword,
            LhsId(Keyword),
            Expression(
                UnionExpression(
                    JoinExpression(
                        OverrideExpression(
                            RestrictExpression(
                                LogicalExpression(
                                    BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
            Keyword,
            LhsId(BasicId),
            Expression(
            UnionExpression(
                JoinExpression(
                    OverrideExpression(
                        RestrictExpression(
                            LogicalExpression(
                                BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
                    Keyword,
                    LhsId(Keyword),
                    Expression(
                        UnionExpression(
                            JoinExpression(
                                OverrideExpression(
                                    RestrictExpression(
                                        LogicalExpression(
                                            BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
                    Keyword,
                    LhsId(Keyword),
                    Expression(
                        UnionExpression(
                            JoinExpression(
                                OverrideExpression(
                                    RestrictExpression(
                                        LogicalExpression(
                                            BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        DefinitionDeclaration(
                    Keyword,
                    LhsId(Keyword),
                    Expression(
                        UnionExpression(
                            JoinExpression(
                                OverrideExpression(
                                    RestrictExpression(
                                        LogicalExpression(
                                            BasicExpression(Literal(BaseLiteral(IntLiteral)))))))))),
        Keyword))
